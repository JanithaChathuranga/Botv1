// Klo mau pake, pake aja ini bkn enc cma terser aja

import fs from"fs";import path from"path";import archiver from"archiver";import JavaScriptObfuscator from"javascript-obfuscator";let handler=async(m,{conn:conn,text:text})=>{const sourceFolder=text,sourceDir=`./${sourceFolder}`;if(fs.existsSync(sourceDir))try{m.reply("Tunggu sebentar, sedang mengenkripsi dan menyimpan file JavaScript...");const files=fs.readdirSync(sourceDir).filter((file=>file.endsWith(".js"))),obfuscatedFiles=[],errorFiles=[];for(const file of files){const filePath=path.join(sourceDir,file),fileContents=fs.readFileSync(filePath,"utf8");try{const obfuscatedCode=JavaScriptObfuscator.obfuscate(fileContents,{compact:!0}).getObfuscatedCode(),obfuscatedFilePath=path.join("./tmp",file);fs.writeFileSync(obfuscatedFilePath,obfuscatedCode),obfuscatedFiles.push(obfuscatedFilePath)}catch(error){console.error(`Error pada file "${file}": ${error.message}`),errorFiles.push({fileName:file,errorReason:error.message})}}if(0===obfuscatedFiles.length)return void m.reply("Tidak ada file JavaScript yang dapat dienkripsi.");if(errorFiles.length>0){const errorMessages=errorFiles.map((fileError=>`File: ${fileError.fileName}, Alasan Error: ${fileError.errorReason}`));m.reply(`Beberapa file tidak dapat dienkripsi:\n${errorMessages.join("\n")}`)}m.reply("Tunggu sebentar, sedang membuat file zip...");const zipFileName=`${sourceFolder}.zip`,outputZipPath=path.join("./tmp",zipFileName),output=fs.createWriteStream(outputZipPath),archive=archiver("zip",{zlib:{level:9}});archive.pipe(output);for(const obfuscatedFile of obfuscatedFiles)archive.append(fs.createReadStream(obfuscatedFile),{name:path.basename(obfuscatedFile)});await archive.finalize(),await conn.sendFile(m.chat,outputZipPath,zipFileName);for(const fileToDelete of[...obfuscatedFiles,outputZipPath])fs.unlinkSync(fileToDelete)}catch(error){console.error(error),m.reply(`Terjadi kesalahan: ${error.message}`)}else m.reply(`Folder "${sourceFolder}" tidak ditemukan.`)};handler.help=["encf <namafolder>"],handler.tags=["owner"],handler.command=/^\encf/i,handler.rowner=!0;export default handler;