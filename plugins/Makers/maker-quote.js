// Klo mau pake, pake aja ini bkn enc cma terser aja

import fetch from"node-fetch";import{support,sticker}from"../../lib/sticker.js";import fs from"fs";import os from"os";import path from"path";let handler=async(m,{conn:conn,text:text})=>{try{if(!text&&!m.quoted)return m.reply("Please provide a text (Type or mention a message)!");let who=m.quoted?m.quoted.sender:m.mentionedJid&&m.mentionedJid[0]?m.mentionedJid[0]:m.fromMe?conn.user.jid:m.sender;if(!(who in global.db.data.users))throw"✳️ The user is not found in my database";global.db.data.users[who];let{name:name}=global.db.data.users[who],quoteJson={type:"quote",format:"png",backgroundColor:"#FFFFFF",width:1800,height:200,scale:2,messages:[{entities:[],avatar:!0,from:{id:1,name:name,photo:{url:"https://i.imgur.com/8B4jwGq.jpeg"}},text:m.quoted?m.quoted.msg:text||"",replyMessage:{}}]},res=await fetch("https://bot.lyo.su/quote/generate",{method:"POST",body:JSON.stringify(quoteJson),headers:{"Content-Type":"application/json"}}),json=await res.json(),bufferImage=Buffer.from(json.result.image,"base64"),tempImagePath=path.join(os.tmpdir(),"tempImage.png");fs.writeFileSync(tempImagePath,bufferImage),await conn.sendFile(m.chat,tempImagePath,"quote.png","Here is the quote image:",m),fs.unlinkSync(tempImagePath)}catch(e){console.error(e)}};handler.help=["quote"],handler.tags=["fun"],handler.command=["quote"];export default handler;