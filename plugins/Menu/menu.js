// Klo mau pake, pake aja ini bkn enc cma terser aja

import{promises,readFileSync}from"fs";import{join}from"path";import{xpRange}from"../../lib/levelling.js";import moment from"moment-timezone";import os from"os";import fs from"fs";import fetch from"node-fetch";import{pickRandom}from"../../lib/other-function.js";const defaultMenu={before:"%m1 *U S E R*\n%m2 *Status:* %prems\n%m2 *Limit:* %limit\n%m2 *Money:* %money\n%m2 *Role:* %role\n%m2 *Level:* %level [ %xp4levelup Xp For Levelup]\n%m2 *Xp:* %exp / %maxexp\n%m2 *Total Xp:* %totalexp\n%m2 *Mode:* %mode\n%m2 *Platform:* %platform\n%m2 *Uptime:* %muptime\n%m2 *Database:* %rtotalreg dari %totalreg\n%m3\n%m1 *L I S T - M E N U*\n%m2 *.menulist*\n%m2 *.allmenu*\n%m2 *.menulist all*\n%m3"};let handler=async(m,{conn:conn,usedPrefix:_p,__dirname:__dirname,args:args})=>{await conn.sendMessage(m.chat,{react:{text:"⏳",key:m.key}});["Kamu nanya?","No spam...","Thanks..","Menampilkan...","Tunggu...","Proses...","Loading...","Bertanya..","Hooh..."].getRandom();let tags={};try{let _muptime,dash=global.dashmenu,m1=global.dmenut,m2=global.dmenub,m3=global.dmenuf,m4=global.dmenub2,cc=global.cmenut,c1=global.cmenuh,c2=global.cmenub,c3=global.cmenuf,c4=global.cmenua,lprem=global.lopr,llim=global.lolm,tag=`@${m.sender.split("@")[0]}`,glb=global.db.data.users,wita=(glb[m.sender],["Kamu nanya?","No spam...","Thanks..","Menampilkan...","Tunggu...","Proses...","Loading...","Bertanya..","Hooh..."].getRandom(),moment.tz("Asia/Jakarta").format("HH:mm:ss"),moment.tz("Asia/Makassar").format("HH"),moment.tz("Asia/Makassar").format("mm"),moment.tz("Asia/Makassar").format("ss"),moment.tz("Asia/Makassar").format("HH:mm:ss")),mode=global.opts.self?"Private":"Publik",_package=JSON.parse(await promises.readFile(join(__dirname,"../package.json")).catch((_=>({}))))||{},{age:age,exp:exp,limit:limit,level:level,role:role,registered:registered,money:money}=glb[m.sender],{min:min,xp:xp,max:max}=xpRange(level,global.multiplier),name=await conn.getName(m.sender),prems=""+(glb[m.sender].premiumTime>0?"Premium":"Free"),platform=os.platform(),ucpn=`${ucapan()}`,d=new Date(new Date+36e5),locale="id",weton=["Pahing","Pon","Wage","Kliwon","Legi"][Math.floor(d/846e5)%5],week=d.toLocaleDateString(locale,{weekday:"long"}),date=d.toLocaleDateString(locale,{day:"numeric",month:"long",year:"numeric"}),dateIslamic=Intl.DateTimeFormat(locale+"-TN-u-ca-islamic",{day:"numeric",month:"long",year:"numeric"}).format(d),time=d.toLocaleTimeString(locale,{hour:"numeric",minute:"numeric",second:"numeric"}),_uptime=1e3*process.uptime();process.send&&(process.send("uptime"),_muptime=1e3*await new Promise((resolve=>{process.once("message",resolve),setTimeout(resolve,1e3)})));let muptime=clockString(_muptime),uptime=clockString(_uptime),totalfeatures=Object.values(global.plugins).filter((v=>v.help&&v.tags)).length,totalreg=Object.keys(glb).length,rtotalreg=Object.values(glb).filter((user=>1==user.registered)).length,help=Object.values(global.plugins).filter((plugin=>!plugin.disabled)).map((plugin=>({help:Array.isArray(plugin.tags)?plugin.help:[plugin.help],tags:Array.isArray(plugin.tags)?plugin.tags:[plugin.tags],prefix:"customPrefix"in plugin,limit:plugin.limit,premium:plugin.premium,enabled:!plugin.disabled})));for(let plugin of help)if(plugin&&"tags"in plugin)for(let tag of plugin.tags)!(tag in tags)&&tag&&(tags[tag]=tag);conn.menu=conn.menu?conn.menu:{};let before=conn.menu.before||defaultMenu.before,_text=(conn.menu.footer,conn.menu.after||(conn.user.jid==global.conn.user.jid||global.conn.user.jid.split`@`[0]),[before].join()),text="string"==typeof conn.menu?conn.menu:"object"==typeof conn.menu?_text:"",replace={"%":"%",p:_p,uptime:uptime,muptime:muptime,me:conn.getName(conn.user.jid),npmname:_package.name,npmdesc:_package.description,version:_package.version,exp:exp-min,maxexp:xp,totalexp:exp,xp4levelup:max-exp,github:_package.homepage?_package.homepage.url||_package.homepage:"[unknown github url]",tag:tag,dash:dash,m1:m1,m2:m2,m3:m3,m4:m4,cc:cc,c1:c1,c2:c2,c3:c3,c4:c4,lprem:lprem,llim:llim,ucpn:ucpn,platform:platform,wita:wita,mode:mode,_p:_p,money:money,age:age,tag:tag,name:name,prems:prems,level:level,limit:limit,name:name,weton:weton,week:week,date:date,dateIslamic:dateIslamic,time:time,totalreg:totalreg,totalfeatures:totalfeatures,rtotalreg:rtotalreg,role:role,readmore:readMore};text=text.replace(new RegExp(`%(${Object.keys(replace).sort(((a,b)=>b.length-a.length)).join`|`})`,"g"),((_,name)=>""+replace[name]));await conn.profilePictureUrl(conn.user.jid).catch((_=>"./src/avatar_contact.png"));pickRandom(global.AraChu2);let prn=`${pickRandom(["./tumnil/1.jpg","./tumnil/2.jpg","./tumnil/3.jpg","./tumnil/4.jpg","./tumnil/5.jpg"])}`,nm=(pickRandom(["https://a.top4top.io/p_1962cau3w1.jpg","https://k.top4top.io/p_1962w2hyp1.jpg","https://j.top4top.io/p_1962ufc7p1.jpg","https://h.top4top.io/p_19629eev81.jpg","https://d.top4top.io/p_1962ahcw21.jpg","https://c.top4top.io/p_1962qiubc1.jpg","https://b.top4top.io/p_1962ck87p1.jpg","https://l.top4top.io/p_1962i85aq1.jpg","https://i.top4top.io/p_19629cg431.jpg","https://g.top4top.io/p_1962o5sp41.jpg","https://f.top4top.io/p_1962vn5rc1.jpg","https://e.top4top.io/p_1962nvj4g1.jpg","https://d.top4top.io/p_1962847na1.jpg","https://c.top4top.io/p_1962tt38s1.jpg","https://b.top4top.io/p_1962vpyp71.jpg","https://a.top4top.io/p_1962fyik51.jpg","https://k.top4top.io/p_1962q7ura1.jpg","https://l.top4top.io/p_19625eppj1.jpg","https://j.top4top.io/p_196252lk91.jpg","https://i.top4top.io/p_1962p9nlk1.jpg"]),pickRandom(global.Pallmenu));await conn.sendMessage(m.chat,{text:text.trim(),contextInfo:{mentionedJid:[m.sender],forwardingScore:256,isForwarded:!0,externalAdReply:{title:global.ucapan,body:"자니야",mediaType:1,thumbnail:await fs.readFileSync(prn),thumbnailUrl:nm,sourceUrl:global.sgc,renderLargerThumbnail:!0}}},{quoted:m})}catch(e){throw await conn.reply(m.chat,"Maaf, menu sedang error",m),e}};handler.command=/^(menu)$/i;export default handler;const more=String.fromCharCode(8206),readMore=more.repeat(4001);function clockString(ms){return[isNaN(ms)?"--":Math.floor(ms/36e5)," H ",isNaN(ms)?"--":Math.floor(ms/6e4)%60," M ",isNaN(ms)?"--":Math.floor(ms/1e3)%60," S "].map((v=>v.toString().padStart(2,0))).join("")}function clockStringP(ms){return[isNaN(ms)?"--":Math.floor(ms/31104e6)%10," *Years 🗓️*\n",isNaN(ms)?"--":Math.floor(ms/2592e6)%12," *Month 🌙*\n",isNaN(ms)?"--":Math.floor(ms/864e5)%30," *Days ☀️*\n",isNaN(ms)?"--":Math.floor(ms/36e5)%24," *Hours 🕐*\n",isNaN(ms)?"--":Math.floor(ms/6e4)%60," *Minute ⏰*\n",isNaN(ms)?"--":Math.floor(ms/1e3)%60," *Second ⏱️*"].map((v=>v.toString().padStart(2,0))).join("")}function ucapan(){const time=moment.tz("Asia/Makassar").format("HH");let res="Selamat DiniHari ☀️";return time>=4&&(res="Good Morning 🌄"),time>=10&&(res="Good Afternoon ☀️"),time>=15&&(res="Good Afternoon 🌇"),time>=18&&(res="Good Night 🌙"),res}