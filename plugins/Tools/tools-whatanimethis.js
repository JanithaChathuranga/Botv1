// Klo mau pake, pake aja ini bkn enc cma terser aja

import uploadImage from"../../lib/uploadImage.js";import fetch from"node-fetch";import*as fs from"fs";let handler=async(m,{conn:conn,usedPrefix:usedPrefix})=>{let q=m.quoted?m.quoted:m,mime=(q.msg||q).mimetype||"";if(!mime)throw"Fotonya?";if(!/image\/(jpe?g|png)/.test(mime))throw`Mime ${mime} tidak support`;let img=await q.download(),upld=await uploadImage(img);await m.reply(wait);let res=await fetch(`https://api.trace.moe/search?anilistInfo&url=${encodeURIComponent(upld)}`),json=await res.json(),{id:id,idMal:idMal,title:title,synonyms:synonyms,isAdult:isAdult}=json.result[0].anilist,{filename:filename,episode:episode,similarity:similarity,video:video,image:image}=json.result[0],_result=`*Title :* ${title.romaji} (${title.native})\n*Synonyms :* ${synonyms}\n*Adult :* ${isAdult}\n*Similiarity :* ${(100*similarity).toFixed(1)}\n*Episode :* ${episode}`;await conn.sendFile(m.chat,image,"wait.jpg",_result,m)};handler.help=["whatanime"],handler.tags=["tools"],handler.command=/^(wait|whatanime|source)$/i,handler.limit=!0;export default handler;